---
title: "Student Success Dashboard Template"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package intialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT, #for better tables
               dplyr
               )

#read in data
cd = readRDS("clean_data.rds")
```

# Project Overview

## Data Overview

Annually, the FSB conducts a senior survey of graduates to learn of their employment status. In addition, information is verified using LinkedIn and employer survey information. The data you are provided ('FSB_BI_Survey_2019_2021.rds') contains data on graduates for 2019, 2020, and 2021. The data are merged from two sources: the senior survey, and data from the Miami University database. The data are anonymized, however it is possible that if you look hard enough, you can identify students. You are bound, ethically not to do so. It is a strict ethical code that you will not discuss individual data points with ANYONE except for me and your team. Failure to comply with this code of ethics will result in a failing grade in the course.

## Project Goals

We intend to determine if there is correlation between student internships and job placement for students at the Farmer School of Business. Using the data provided by the client (Mr. Kirk Bogard), we will conduct an analysis to determine if there is a relationship. Ideally, we can provide a chart or graph of our findings in order to provide an easy visualization for students, career services staff, and prospective donors to understand the value that internships have upon post-graduate job placement. Thus, the primary goals are to determine the relationship between internships and post-grad job placement and communicate the results of the analysis in an easy to comprehend format that conveys the findings accurately

## Written Insights

Insert once analysis is completed with written insights and links to otherp ages that support our conclusions.

# Survey Overview {data-orientation="columns"}

Overview of survey responses

## row {data-width="300"}

### Usable Response Rate

```{r, echo = FALSE}
rate=round(100*nrow(cd)/3235,0) ## need better number
gauge(rate, min=0,max=100,symbol='%',gaugeSectors(success=c(80,100),warning=c(40,79),danger = c(0,39)))
```

### Usable Responses

```{r,echo=FALSE}
nusable=nrow(cd)
valueBox(nusable,icon="fa-users")
# you can find the icons here:https://fontawesome.com/icons
# note that I have been unable to get all icons to work
```

### Internship Count

```{r,echo=FALSE}
p=ggplot(cd,aes(survey_internships))+
  geom_bar(color="steelblue",fill="steelblue")+
  xlab("Internship Status")+
  ylab("Number of Responses")+
  theme_bw()
ggplotly(p)
```

## row {data-height="600"}

### Internship Rate by Primary Major

```{r,echo=FALSE}
internships_by_major <- cd %>%
  mutate(at_least_one_internship = ifelse(survey_internships > 0, 1, 0))

internship_rate <- internships_by_major %>%
  group_by(major1) %>%
  summarize(internship_rate = mean(at_least_one_internship))

p <- ggplot(internship_rate, aes(x = major1, y = internship_rate)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Internship Rate by Major",
       x = "Major",
       y = "Internship Rate") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(p)
```

### Offer Rate by Primary Major

```{r,echo=FALSE}
offers_by_major <- cd %>%
  mutate(at_least_one_offer = ifelse(survey_offers > 0, 1, 0))

offer_rate <- offers_by_major %>%
  group_by(major1) %>%
  summarize(offer_rate = mean(at_least_one_offer))

p = ggplot(offer_rate, aes(x = major1, y = offer_rate)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Offer Rate by Major",
       x = "Major",
       y = "Offer Rate") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(p)
```

# Analysis Results {data-orientation="columns"}

## Column {data-width="400"}

### Internship Status by Major

```{r,echo=FALSE}

```

### Job Offer Counts

```{r,echo=FALSE}

```

## Column {data-width="600"}

### Number of Internships by Job Offer

```{r,echo=FALSE}

```
